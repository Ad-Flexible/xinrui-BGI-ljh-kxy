## 所有涉及字段



1. sampleId —— 必需 —— 样本编号
2. poolingSubId —— 必需 —— 子文库号
3. slideId —— 必需 —— 芯片号
4. laneId —— 必需 —— Lane ID
5. dnbId —— 必需 —— DNB ID
6. sampleType —— 必需 —— 样本类型（如：全血、血浆、DNA）
7. shipmentCondition —— 必需 —— 运输条件
8. collectDate——必需——取样日期
9. receivedDate —— 必需 —— 收样日期
10. gestationalWeeks —— 必需 —— 孕周(周天)
11. fetusType —— 必需 —— 胎儿类型（如：单胎、双胎）
12. tubeType —— 必需 —— 采血管类型（如：EDTA管）
13. additionalReportFlag —— 可为空 —— 是否需要附加报告
14. oldSampleNum —— 必需 —— 原样本编号
15. patientName —— 可为空 —— 孕妇姓名
16. patientIdCard —— 可为空 —— 身份证号
17. patientAge —— 可为空 —— 年龄
18. clinicNum —— 可为空 —— 门诊号
19. hospitalName —— 可为空 —— 送检医院
20. doctorName —— 可为空 —— 送检医生
21. patientAddress —— 可为空 —— 联系地址
22. patientMobile —— 可为空 —— 手机号码
23. lastMenstrualPeriod —— 可为空 —— 末次月经
24. chorion —— 可为空 —— 绒毛膜类型（如：DC、DA、MC等）
25. downScreening —— 可为空 —— 唐筛结果（如：13-三体，低风险）
26. bUltrasonography —— 可为空 —— B超检查结果（如：正常单活胎）
27. ivfFlag —— 可为空 —— 是否IVF（是/否）
28. conceptionMethod —— 可为空 —— 受孕方式（如：自然受孕、IUI、IVF-ET）
29. bhGravidity —— 可为空 —— 分娩史-孕次
30. bhParity —— 可为空 —— 分娩史-产次
31. bhOther —— 可为空 —— 分娩史-其它
32. amniocentesis —— 可为空 —— 羊水穿刺结果
33. illnessHistoryPast —— 可为空 —— 既往史
34. illnessHistoryPresent —— 可为空 —— 现病史/临床诊断
35. illnessHistoryAllergy —— 可为空 —— 过敏史
36. illnessHistoryGenetic —— 可为空 —— 家族遗传病史
37. patientRemark —— 可为空 —— 备注
38. sampleQcResult —— 可为空 —— 样本质控结果（通过、不通过）
39. recommendedOperation —— 可为空 —— 操作建议（如：合格、重上机等）
40. doctorOpinion —— 可为空 —— 医生意见（如：合格、重上机等）
41. detectionResult —— 可为空 —— 检测结果（如：合格阴性、合格阳性等）
42. reportType —— 可为空 —— 报告类型（如：单胎报告、双胎报告等）
43. zChr13 —— 可为空 —— Z(chr13)值
44. zChr18 —— 可为空 —— Z(chr18)值
45. zChr21 —— 可为空 —— Z(chr21)值
46. testChr13 —— 可为空 —— 13号染色体风险判定（如：未检出T13、chr13偏高等）
47. testChr18 —— 可为空 —— 18号染色体风险判定（如：未检出T18、chr18偏高等）
48. testChr21 —— 可为空 —— 21号染色体风险判定（如：未检出T21、chr21偏高等）
49. testChrSex —— 可为空 —— 性染色体检测结果（如：未检出异常、XO高危等）
50. abnormalChrX —— 可为空 —— 性染色体异常提示（X/Y浓度）
51. chrN —— 可为空 —— 补充信息（如：单样本流程）
52. fetalFaction —— 可为空 —— 胎儿浓度
53. childLvChr13 —— 可为空 —— 13号染色体浓度(%)
54. childLvChr18 —— 可为空 —— 18号染色体浓度(%)
55. childLvChr21 —— 可为空 —— 21号染色体浓度(%)
56. testDeletionDuplication —— 可为空 —— 缺失重复检测结果（如：dup(18p11.31p11.23,1.48M)-M）
57. abnormalChrNum —— 可为空 —— 异常染色体数
58. fracAbs —— 可为空 —— 性染色体浓度差
59. riskIndex13 —— 可为空 —— 13号染色体风险值
60. riskIndex18 —— 可为空 —— 18号染色体风险值
61. riskIndex21 —— 可为空 —— 21号染色体风险值
62. testChrOther —— 可为空 —— 其他常染色体异常
63. repeatCount —— 可为空 —— 是否重复样本（数值大于1即为重复）
64. testTime —— 可为空 —— 检测时间
65. reportCreateTime —— 可为空 —— 报告创建时间
66. diseaseList —— 可为空 —— 疾病表型列表
67. cytoband —— 可为空 —— 区带信息
68. chr —— 可为空 —— 染色体编号（1-23）
69. delDup —— 可为空 —— CNV缺失/重复描述
70. site —— 可为空 —— 位点信息
71. cnvType —— 可为空 —— 异常类型（如：del, dup）
72. cnvSize —— 可为空 —— 片段大小
73. disease —— 可为空 —— 疾病名称
74. detail —— 可为空 —— 疾病描述
75. diseaseDetail —— 可为空 —— 表型/临床表型描述
76. productNo —— 可为空 —— 产品套餐编号
77. productName —— 可为空 —— 产品套餐名称
78. otherDiseaseList —— 可为空 —— 其他疾病列表
79. cytoband —— 可为空 ——区带信息
80. disease —— 可为空 —— 疾病名
81. chr —— 可为空 ——疾病名
82. delDup ——可为空 ——cnv缺失重复
83. diseaseDetail ——可为空 —— 表型
84. cnvType ——可为空 ——异常类型
85. cnvSize ——可为空 ——片段大小
86. site ——可为空 ——位点信息
87. detail ——可为空 ——疾病描述
88. sampleQc —— 可为空 —— 样本质控信息
89. sampleGc —— 可为空 —— 样本GC含量(%)
90. uniqueReads —— 可为空 —— 有效数据量(M)
91. readsNum —— 可为空 —— 原始数据量(M)
92. duplicationRate —— 可为空 —— 重复率(%)
93. mapRate —— 可为空 —— 比对率(%)
94. laneQc —— 可为空 —— Lane质控信息
95. laneQcResult —— 可为空 —— lane质控结果（通过、不通过）
96. laneQcReason —— 可为空 —— 质控失败原因
97. readsNum ——可为空 ——原始数据量均值(M)
98. failSampleRate —— 可为空 —— Fail_Rate(%)
99. laneGc —— 可为空 —— GC_mean(%)
100. totalReads —— 可为空 —— 总产量(M)
101. q20 —— 可为空 —— Q20(%)
102. mapRate ——可为空 ——比对率(%)
103. duplicateRate —— 可为空 —— 重复率(%)
104. totalDecodeRate —— 可为空 —— 拆分率(%)
105. dimRate —— 可为空 —— Dim_Rate(%)

---



### 1. 样本主表 `T_Sample`
缺少送检科室字段
![](document/img.png)
```sql
CREATE TABLE T_Sample (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '主键',
    intver INT DEFAULT 0 NOT NULL COMMENT '数据版本',
    updated_by BIGINT COMMENT '最后更新人ID',
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    
    -- 核心标识（业务唯一键）
    sample_id VARCHAR(50) NOT NULL COMMENT '样本编号',
<<<<<<< HEAD
    pooling_sub_id VARCHAR(60) UNIQUE COMMENT '子文库号（业务唯一键）',
    slide_id VARCHAR(50) COMMENT '芯片号',
    lane_id VARCHAR(20) COMMENT 'Lane ID',
    dnb_id VARCHAR(60) COMMENT 'DNB ID',
    
    -- 样本属性（关联字典表）
    sample_type int NOT NULL COMMENT '样本类型代码',
    shipment_condition int NOT NULL COMMENT '运输条件',
    tube_type int NOT NULL COMMENT '采血管类型代码',
=======
    --去掉notnull
    pooling_sub_id VARCHAR(60) NOT NULL UNIQUE COMMENT '子文库号（业务唯一键）',
    slide_id VARCHAR(50) NOT NULL COMMENT '芯片号',
    lane_id VARCHAR(20) NOT NULL COMMENT 'Lane ID',
    dnb_id VARCHAR(60) NOT NULL COMMENT 'DNB ID',
    --end
    
    -- 样本属性（关联字典表）
    --更改为int类型
    sample_type_code VARCHAR(20) NOT NULL COMMENT '样本类型代码→T_Dict_Sample_Type',
    shipment_condition VARCHAR(20) NOT NULL COMMENT '运输条件',
    tube_type_code VARCHAR(20) NOT NULL COMMENT '采血管类型代码→T_Dict_Tube_Type',
    --end
>>>>>>> 5b4accd6ded05c5cf4c5d9f98bb3db5dda0b1f4f
    
    -- 时间属性（强类型DATETIME）
    collect_date DATETIME NOT NULL COMMENT '取样时间',
    received_date DATETIME NOT NULL COMMENT '收样时间',
    test_time DATETIME COMMENT '检测时间',
    report_create_time DATETIME COMMENT '报告创建时间',
    
    -- 孕产信息（原子化拆分）
    gestational_weeks INT NOT NULL COMMENT '孕周（整数）',
    gestational_days INT NOT NULL COMMENT '孕天（0-6）',
<<<<<<< HEAD
    fetus_type int NOT NULL COMMENT '胎儿类型代码',
    
    -- 业务属性
    old_sample_num VARCHAR(32) NOT NULL COMMENT '原样本编号',
    additional_report_flag int COMMENT '附加报告标志 Y/N,枚举：1. 是、2. 否',
    repeat_count INT DEFAULT 1 COMMENT '重复次数（>1为重复样本）',
    product_no VARCHAR(50) NOT NULL COMMENT '产品套餐编号',
    product_name VARCHAR(100) NOT NULL COMMENT '产品套餐名称',
    clinic_num VARCHAR(50) COMMENT '门诊号',          
    hospital_name VARCHAR(50) COMMENT '送检医院',
    department_name VARCHAR(50) COMMENT '送检科室',
    doctor_name VARCHAR(20) COMMENT '送检医生',        
=======
    --更改为int类型
    fetus_type_code VARCHAR(10) NOT NULL COMMENT '胎儿类型代码→T_Dict_Fetus_Type',
    --end
    
    -- 业务属性
    --更改为varchar（32）
    old_sample_num VARCHAR(60) NOT NULL COMMENT '原样本编号',
    --end
    --更改为int类型
    additional_report_flag CHAR(1) COMMENT '附加报告标志 Y/N',
    --end
    
    repeat_count INT DEFAULT 1 COMMENT '重复次数（>1为重复样本）',
    --产品套餐编号不为空
    product_no VARCHAR(50) COMMENT '产品套餐编号',
    --产品套餐名称不为空，VARCHAR(256)
    product_name VARCHAR(100) COMMENT '产品套餐名称',
    clinic_num VARCHAR(50) COMMENT '门诊号',    
    --更改为varchar（50）
    hospital_name VARCHAR(100) COMMENT '送检医院',  
    --更改为varchar（20）
    doctor_name VARCHAR(50) COMMENT '送检医生',        
>>>>>>> 5b4accd6ded05c5cf4c5d9f98bb3db5dda0b1f4f
    
    -- 索引优化
    INDEX idx_sample_id (sample_id),
    INDEX idx_pooling_sub_id (pooling_sub_id),
    INDEX idx_collect_date (collect_date),
    INDEX idx_slide_lane (slide_id, lane_id)
) ENGINE=InnoDB COMMENT='样本核心流程信息表（电子病历主索引）';
```

### 2. 患者信息表 `T_Patient_Info`（一对一）
以下为缺少的字段，接口文档目录5，未标注粉色的
![](document/image-20260210095331207.png)
```sql
--缺少出生日期，身高、体重、家庭电话、紧急联系人、关系、联系人电话、预产期
CREATE TABLE T_Patient_Info (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY,
    intver INT DEFAULT 0 NOT NULL,
    updated_by BIGINT,
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    sample_oid BIGINT NOT NULL UNIQUE COMMENT '关联T_Sample.oid',
    
    -- 敏感信息（应用层加密存储）
<<<<<<< HEAD
    patient_name VARCHAR(30) COMMENT '孕妇姓名',
    patient_id_card VARCHAR(20) COMMENT '身份证号【敏感-需加密】',
=======
    --更改为varchar（30）
    patient_name VARCHAR(50) COMMENT '孕妇姓名',
    --更改为varchar（20）
    patient_id_card VARCHAR(18) COMMENT '身份证号【敏感-需加密】',
>>>>>>> 5b4accd6ded05c5cf4c5d9f98bb3db5dda0b1f4f
    patient_mobile VARCHAR(20) COMMENT '手机号【敏感-需加密】',
    
    -- 基础信息
    patient_age INT COMMENT '年龄',
    patient_address VARCHAR(200) COMMENT '联系地址',
    patient_birthday BIGINT COMMENT '出生日期：毫秒',
    patient_height DECIMAL(5,3) COMMENT '身高[0,500] ，支持2位小数',
    patient_weight DECIMAL(5,3) COMMENT '体重[0,500]，支持2位小数',
    patient_tel VARCHAR(20) COMMENT '家庭电话',
    emergent_name VAECHAR(30) COMMENT '紧急联系人',
    emergent_relation VARCHAR(20) COMMENT '与紧急联系人的关系',
    emergent_tel VARCHAR(20) COMMENT '紧急联系人电话',     
    patient_edd VARCHAR(10) COMMENT '预产期',
    
    -- 孕产史
    last_menstrual_period DATE COMMENT '末次月经',
<<<<<<< HEAD
    chorion int COMMENT '绒毛膜类型',
    down_screening_result int COMMENT '唐筛结果',
    b_ultrasonography int COMMENT 'B超检查结果',
    ivf_flag int COMMENT '是否IVF Y/N,枚举：1. 是、2. 否',
    conception_method int COMMENT '受孕方式',
=======
    --更改为int，是否应该放入检测结果的表
    chorion_code VARCHAR(10) COMMENT '绒毛膜类型代码→T_Dict_Chinion',
    down_screening_result VARCHAR(100) COMMENT '唐筛结果',
    b_ultrasonography VARCHAR(200) COMMENT 'B超检查结果',
    ivf_flag CHAR(1) COMMENT '是否IVF Y/N',
    conception_method_code VARCHAR(20) COMMENT '受孕方式代码→T_Dict_Conception',
    --end
>>>>>>> 5b4accd6ded05c5cf4c5d9f98bb3db5dda0b1f4f
    
    -- 分娩史
    bh_gravidity INT COMMENT '孕次',
    bh_parity INT COMMENT '产次',
<<<<<<< HEAD
    bh_other VARCHAR(50) COMMENT '其他分娩史',
    
    -- 病史(在文档中描述多为String(200)，不知道是否使用TEXT还是VARCHAR(200)好 )
=======
    --使用varchar（50）？
    bh_other TEXT COMMENT '其他分娩史',
    
    -- 病史
    --更改为varchar（200）类型？
>>>>>>> 5b4accd6ded05c5cf4c5d9f98bb3db5dda0b1f4f
    amniocentesis_result TEXT COMMENT '羊水穿刺结果',
    illness_history_past TEXT COMMENT '既往史',
    illness_history_present TEXT COMMENT '现病史/临床诊断',
    illness_history_allergy TEXT COMMENT '过敏史',
    illness_history_genetic TEXT COMMENT'家族遗传病史',
    patient_remark TEXT COMMENT '备注',
    --end
    
    FOREIGN KEY (sample_oid) REFERENCES T_Sample(oid) ON DELETE CASCADE,
    INDEX idx_hospital (hospital_name),
    INDEX idx_clinic_num (clinic_num)
) ENGINE=InnoDB COMMENT='患者临床信息表（符合电子病历四级隐私要求）';
```

### 3. 样本质控表 `T_Sample_Qc`（一对一）
```sql
CREATE TABLE T_Sample_Qc (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY,
    intver INT DEFAULT 0 NOT NULL,
    updated_by BIGINT,
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    sample_oid BIGINT NOT NULL UNIQUE,
    sample_qc_result VARCHAR(20) COMMENT '样本质控结果',
    
    
    -- 强类型数值（DECIMAL精度保障）
    sample_gc DECIMAL(5,3) COMMENT 'GC含量(%)',
    unique_reads DECIMAL(10,3) COMMENT '有效数据量(M)',
    reads_num DECIMAL(10,3) COMMENT '原始数据量(M)',
    duplication_rate DECIMAL(5,3) COMMENT '重复率(%)',
    map_rate DECIMAL(5,3) COMMENT '比对率(%)',
    
    FOREIGN KEY (sample_oid) REFERENCES T_Sample(oid) ON DELETE CASCADE
) ENGINE=InnoDB COMMENT='样本质控明细表（数值精度保障）';
```

### 4. Lane质控表 `T_Lane_Qc`（一对一）
```sql
CREATE TABLE T_Lane_Qc (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY,
    intver INT DEFAULT 0 NOT NULL,
    updated_by BIGINT,
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    sample_oid BIGINT NOT NULL UNIQUE,
    lane_qc_result VARCHAR(10) COMMENT 'lane质控',
    lane_qc_reason VARCHAR(200) COMMENT '质控失败原因',
    
    -- 强类型数值（避免字段重复命名冲突）
    lane_reads_num DECIMAL(10,3) COMMENT '原始数据量均值(M)',
    lane_map_rate DECIMAL(5,3) COMMENT '比对率(%)',
    total_decode_rate DECIMAL(5,3) COMMENT '拆分率(%)',
    lane_duplicate_rate DECIMAL(5,3) COMMENT '重复率(%)',
    fail_sample_rate DECIMAL(5,3) COMMENT 'Fail_Rate(%)',
    lane_gc DECIMAL(5,3) COMMENT 'GC_mean(%)',
    total_reads DECIMAL(10,3) COMMENT '总产量(M)',
    q20 DECIMAL(5,3) COMMENT 'Q20(%)',
    dim_rate DECIMAL(5,3) COMMENT 'Dim_Rate(%)',
    
    FOREIGN KEY (sample_oid) REFERENCES T_Sample(oid) ON DELETE CASCADE
) ENGINE=InnoDB COMMENT='Lane质控明细表（字段命名规避重复）';
```

### 5. 检测结果主表 `T_Detection_Result`（一对一）
```sql
CREATE TABLE T_Detection_Result (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY,
    intver INT DEFAULT 0 NOT NULL,
    updated_by BIGINT,
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    sample_oid BIGINT NOT NULL UNIQUE,
    detection_result VARCHAR(50) COMMENT '检测结果',
    report_type VARCHAR(20) COMMENT '报告类型',
    
    -- Z值（DECIMAL保障精度）
    z_chr13 DECIMAL(8,3),
    z_chr18 DECIMAL(8,3),
    z_chr21 DECIMAL(8,3),
    
    -- 风险判定
    test_chr13 VARCHAR(20) COMMENT '13号染色体三体检测',
    test_chr18 VARCHAR(20) COMMENT '18号染色体三体检测',
    test_chr21 VARCHAR(20) COMMENT '21号染色体三体检测',
    test_chr_sex VARCHAR(50) COMMENT '性染色体结果',
    abnnormal_car_x VARCHAR(50) COMMENT '性染色体异常提示'
    
  
    
    -- 性染色体（原子化拆分）
    abnormal_chr_x_val1 DECIMAL(8,3) COMMENT 'X浓度1',
    abnormal_chr_x_val2 DECIMAL(8,3) COMMENT 'X浓度2',
    frac_abs DECIMAL(8,3) COMMENT '浓度差',
    
    -- 胎儿浓度
    fetal_fraction DECIMAL(5,3) COMMENT '胎儿浓度(%)',
    child_lv_chr13 DECIMAL(5,3) COMMENT '13号染色体浓度(%)',
    child_lv_chr18 DECIMAL(5,3) COMMENT '18号染色体浓度(%)',
    child_lv_chr21 DECIMAL(5,3) COMMENT '21号染色体浓度(%)',
    
    -- 风险值（分子/分母分离，避免字符串）
    risk_index_13_numerator BIGINT COMMENT '13号风险分子',
    risk_index_13_denominator BIGINT COMMENT '13号风险分母',  -- 因为是以分数形式传过来，看看要不要添加一个小数形式的值用于存储
    risk_index_18_numerator BIGINT,
    risk_index_18_denominator BIGINT,
    risk_index_21_numerator BIGINT,
    risk_index_21_denominator BIGINT,
    
    -- 汇总字段
    test_deletion_duplication VARCHAR(200) COMMENT 'Test(缺失重复)',
    test_chr_other VARCHAR(200) COMMENT '其他染色体异常',
    abnormal_chr_num INT COMMENT '异常染色体计数',
    chr_n VARCHAR(50) COMMENT '补充信息',
    
    recommended_operation VARCHAR(50) COMMENT '操作建议',   **
    doctor_opinion VARCHAR(50) COMMENT '医生意见',    **
    
    FOREIGN KEY (sample_oid) REFERENCES T_Sample(oid) ON DELETE CASCADE,
    INDEX idx_detection_result (detection_result)
) ENGINE=InnoDB COMMENT='检测核心结果表（强类型+审计冗余）';
```

### 6. CNV详细记录表 `T_Detection_Cnv`（一对多）
```sql
CREATE TABLE T_Detection_Cnv (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY,
    intver INT DEFAULT 0 NOT NULL,
    updated_by BIGINT,
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    detection_result_oid BIGINT NOT NULL COMMENT '关联T_Detection_Result.oid',
    cnv_category CHAR(1) NOT NULL COMMENT '类别: D=diseaseList, O=otherDiseaseList',
    
    -- CNV核心属性
    cytoband VARCHAR(100) NOT NULL COMMENT '区带信息',
    chr_num TINYINT NOT NULL COMMENT '染色体编号(1-23)',
    cnv_type VARCHAR(10) NOT NULL COMMENT '异常类型 del/dup',
    cnv_size DECIMAL(10,2) COMMENT '片段大小(M)',
    site VARCHAR(150) COMMENT '位点信息',
    del_dup_desc TEXT COMMENT 'CNV描述',
    
    -- 疾病关联
    disease_name VARCHAR(200) COMMENT '疾病名称',
    disease_detail TEXT COMMENT '表型',
    clinical_phenotype TEXT COMMENT '临床表型描述',
    
    FOREIGN KEY (detection_result_oid) REFERENCES T_Detection_Result(oid) ON DELETE CASCADE,
    INDEX idx_detection_result (detection_result_oid),
    INDEX idx_cnv_category (cnv_category),
    INDEX idx_chr_num (chr_num)
) ENGINE=InnoDB COMMENT='CNV详细记录表（diseaseList+otherDiseaseList合并存储）';
```

### 7. 其他染色体异常表 `T_Detection_Other_Chr`（一对多）
```sql
CREATE TABLE T_Detection_Other_Chr (
    oid BIGINT AUTO_INCREMENT PRIMARY KEY,
    intver INT DEFAULT 0 NOT NULL,
    updated_by BIGINT,
    updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    detection_result_oid BIGINT NOT NULL,
    chromosome VARCHAR(10) NOT NULL COMMENT '染色体标识 如 T7',
    z_value DECIMAL(8,3) NOT NULL COMMENT 'Z值',
    
    FOREIGN KEY (detection_result_oid) REFERENCES T_Detection_Result(oid) ON DELETE CASCADE,
    INDEX idx_detection_result (detection_result_oid)
) ENGINE=InnoDB COMMENT='其他染色体异常明细表（拆分testChrOther）';
```

---

> 